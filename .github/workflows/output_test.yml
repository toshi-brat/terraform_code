# Basic workflow to see Outputs
name: Output

# Running Workflow Manually
on:
  workflow_dispatch:

jobs:
  job:
    runs-on: ubuntu-latest
    steps:    
       
      - name: "Generating Token"
        id: get_workflow_token
        uses: tibdex/github-app-token@v1
        with:
          app_id: ${{ secrets.APP_ID }}
          private_key: ${{ secrets.PRIVATE_KEY }}
    
    
      - name: Repo Dispatch
        env: 
          DEPLOYMENT_NOTIFICATION_URL: https://api.github.com/repos/toshi-brat/terraform_code/dispatches
          GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}
        run: |
          curl \
           -X POST \
           -H "Accept: application/vnd.github+json" \
           -H "Authorization: Bearer ${{ steps.generate_token.outputs.token }} " \
           https://api.github.com/repos/toshi-brat/terraform_code/dispatches \
           -d '{"event_type":"on-demand-test","client_payload":{"unit":false,"integration":true}}'

     
        
   
     
